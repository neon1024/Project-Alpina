define("ds2-scroll",["jquery","ds2-main"],function(f){return function(g){this.el=g;this.startTop=this.startY=0;this.lineHeight=16;this.setScrollBar=function(){this.el.setAttribute("data-scroll",!0);var a=this.el.scrollHeight>this.el.offsetHeight,b=f(this.el).children(".scroll-bar-content");0<b.length?this.scrollBarContent=b[0]:(this.scrollBarContent=document.createElement("div"),this.scrollBarContent.classList.add("scroll-bar-content"),this.el.appendChild(this.scrollBarContent));b=this.scrollBarContent.getElementsByClassName("scroll-bar");
this.scrollBarContent&&0<b.length?this.scrollBar=b[0]:(this.scrollBar=document.createElement("div"),this.scrollBar.classList.add("scroll-bar"),this.scrollBarContent.appendChild(this.scrollBar));a?this.scrollBarContent.classList.add("scrollable"):a||this.scrollBarContent.classList.remove("scrollable")}.bind(this);this.getMetrics=function(){var a=this.el.scrollTop,b=this.el.offsetHeight,c=this.el.scrollHeight,d=a+b,e=this.el.offsetTop,h=e+c,f=e<a?a:e,g=h>d?d:h,n=d-a,p=this.scrollBarContent?this.scrollBarContent.offsetHeight:
0,k=c/n,l=parseInt(p/k),m=parseInt(a/k);return{scrollTop:a,scrollBot:d,elTop:e,elBottom:h,visibleBottom:g,visibleTop:f,visibleHeight:n,offsetHeight:b,totalHeight:c,scrollBarHeight:l,scrollBarContentHeight:p,scrollBarTop:m+l>c?c-l:0<=m?m:0,heightAr:k}}.bind(this);this.setBarPosition=function(){this.setScrollBar();var a=this.getMetrics();this.scrollBar.setAttribute("style","height:"+a.scrollBarHeight+"px; top:"+a.scrollBarTop+"px");this.scrollBarContent.setAttribute("style","top:"+a.scrollTop+"px")}.bind(this);
this.scrollTop=function(a){this.el.scrollTop=a||0}.bind(this);this.setDragging=function(a){(this.dragging=a)?this.el.classList.add("scrolling"):this.el.classList.remove("scrolling")}.bind(this);this.startDragging=function(a,b){this.setDragging(!0);this.startY=b?a.targetTouches[0].clientY:a.clientY;this.startTop=this.el.scrollTop}.bind(this);this.init=function(){this.setBarPosition();window.addEventListener("resize",function(){this.setBarPosition();this.setDragging(!1)}.bind(this));this.el.addEventListener("scroll",
function(){this.setBarPosition()}.bind(this));this.scrollBar.addEventListener("mousedown",function(a){this.startDragging(a)}.bind(this));this.el.addEventListener("mousedown",function(a){2===a.which&&this.startDragging(a)}.bind(this));document.addEventListener("mousemove",function(a){if(this.dragging){var b=this.getMetrics();this.el.scrollTop=this.startTop+(a.clientY-this.startY)*b.heightAr;this.setBarPosition()}}.bind(this));document.addEventListener("wheel",function(a){if(this.getScrollParent(a.target)===
this.el){a.preventDefault();var b=this.getMetrics();this.el.scrollTop=b.scrollTop+(15<=a.deltaY||-15>=a.deltaY?a.deltaY:a.deltaY*this.lineHeight);this.setBarPosition()}}.bind(this),{passive:!1});this.scrollBarContent.addEventListener("click",function(a){if(a.target!==this.scrollBar){var b=this.getMetrics();this.el.scrollTop=a.offsetY*b.heightAr;this.setBarPosition()}this.setDragging(!1)}.bind(this));document.addEventListener("mouseup",function(){this.setDragging(!1)}.bind(this));document.addEventListener("touchstart",
function(a){this.getScrollParent(a.target)===this.el&&(event.stopPropagation&&(event.stopPropagation(),event.preventDefault()),this.el.classList.add("touching"),this.startDragging(a,!0))}.bind(this),window.digitals2.main.supportsPassiveEventListeners()?{passive:!0}:!1);this.scrollBar.addEventListener("touchstart",function(a){this.el.classList.add("touching");this.startDragging(a,!0);this.touchDirection=-1}.bind(this),window.digitals2.main.supportsPassiveEventListeners()?{passive:!0}:!1);document.addEventListener("touchmove",
function(a){a.preventDefault;if(this.dragging){var b=this.getMetrics();this.el.scrollTop=this.startTop+this.touchDirection*(this.startY-a.targetTouches[0].clientY)*b.heightAr;this.setBarPosition()}}.bind(this),window.digitals2.main.supportsPassiveEventListeners()?{passive:!0}:!1);document.addEventListener("touchend",function(){this.el.classList.remove("touching");this.setDragging(!1);this.touchDirection=1}.bind(this));this.getScrollParent=function(a){return a?!(a instanceof HTMLDocument)&&a.getAttribute("data-scroll")&&
a.scrollHeight>a.clientHeight?a:this.getScrollParent(a.parentNode):null}.bind(this)};this.el&&this.init();return this}});