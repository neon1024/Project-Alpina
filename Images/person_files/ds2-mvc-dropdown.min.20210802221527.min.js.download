define("ds2-dropdown-model",[],function(){var c=function(b,a){if(!b||"emitter"!==b.name)throw Error("DropdownModel: Emitter is required.");this.emitter=b;this.uid=this.emitter.uid;this._isOpen=a.isOpen||!1;this._showFilter=a.showFilter||!1;this._title=a.title||"";this._skipPreselection=a.skipPreselection||!1};c.prototype.isOpen=function(){return this._isOpen};c.prototype.open=function(){this._isOpen=!0;this.emitter.trigger("open")};c.prototype.close=function(){this._isOpen=!1;this.emitter.trigger("close")};
c.prototype.hasFilter=function(){return this._showFilter};c.prototype.showFilter=function(){this._showFilter=!0;this.emitter.trigger("showFilter")};c.prototype.hideFilter=function(){this._showFilter=!1;this.emitter.trigger("hideFilter")};c.prototype.setTitle=function(b){this._title!==b&&(this._title=b,this.emitter.trigger("title-change",this._title))};c.prototype.setItemList=function(b){this.items=b};c.prototype.getListItems=function(){return this.items};c.prototype.setVisibleItems=function(b){this.visibleItems=
b;this.emitter.trigger("listitems-change",this.visibleItems)};c.prototype.shouldPreselectItem=function(){return!this._skipPreselection};return c});
define("ds2-dropdown-view",["ds2-accessibility"],function(c){var b=function(a){if(!a||!a.element)throw Error("DropdownView: Element is required.");if(!a.emitter||!a.controller||a.emitter.uid!==a.controller.uid)throw Error("DropdownView: Emitter and controller are required.");this.accessibility=new c(this.element);this.element=a.element;this.emitter=a.emitter;this.controller=a.controller;this.access=a.accessibility;this.ddParentClass=a.parentClass||"ds2-dropdown";this.hash=a.hash||"";this.sel={ddArea:this.ddParentClass+
"-js-area",ddContainer:this.ddParentClass+"-js-container",ddItem:this.ddParentClass+"__js-item",ddTitle:this.ddParentClass+"__js-title",ddLink:this.ddParentClass+"__link",ddFilterInput:this.ddParentClass+"__filter",ddOpen:this.ddParentClass+"--open",ddFilterActive:this.ddParentClass+"--filter-active",ddItemActive:this.ddParentClass+"-list__item--active"};this.title=this.element.getElementsByClassName(this.sel.ddTitle)[0];this.list=this.element.getElementsByClassName(this.sel.ddContainer)[0];this.toggle=
this.element.getElementsByClassName(this.sel.ddArea)[0];this.quickSearch=this.element.getElementsByClassName(this.sel.ddFilterInput)[0];this.itemList=this.element.getElementsByClassName(this.sel.ddItem);this.toggle&&this.toggle.addEventListener("click",this.controller.toggleOpen.bind(this.controller));this.list&&this.list.addEventListener("click",this.selectItem.bind(this));this.quickSearch&&this.quickSearch.addEventListener("input",this.controller.applyFilter.bind(this.controller));document.body.addEventListener("click",
this.focusOut.bind(this));this.emitter.on("open",this.open.bind(this));this.emitter.on("close",this.close.bind(this));this.emitter.on("showFilter",this.showFilter.bind(this));this.emitter.on("hideFilter",this.hideFilter.bind(this));this.emitter.on("title-change",this.changeTitle.bind(this));this.emitter.on("listitems-change",this.visibleItems.bind(this));this.init()};b.prototype.init=function(){this.controller.checkFilter();this.controller.setItemList(this.itemList);this.controller.shouldPreselectItem()&&
this.preselectItem()};b.prototype.preselectItem=function(){var a=this.element.querySelectorAll('[href\x3d"'+this.hash+'"]')[0];a?this.setActiveItem(a):(a=this.element.querySelectorAll('a[href*\x3d"'+document.location.pathname+'"]')[0])?this.setActiveItem(a):(a=this.element.querySelectorAll("li.ds2-dropdown-list__item--active \x3e a")[0])?this.setActiveItem(a):this.setActiveItem(this.itemList[0])};b.prototype.open=function(){this.element.classList.add(this.sel.ddOpen);var a=this.accessibility.getKeyboardFocusableElements(this.list.querySelector(".ds2-dropdown-list__item--active"));
this.controller.hasFilter()?setTimeout(function(){this.quickSearch.focus()}.bind(this),10):setTimeout(function(){var d=this.findItemIndex();this.access.updateFocusableElements(d);a[0]&&a[0].focus()}.bind(this),10)};b.prototype.findItemIndex=function(){return this.list.querySelector(".ds2-dropdown-list__item--active").querySelector(".ds2-link").getAttribute("data-list-id")};b.prototype.close=function(){this.element.classList.remove(this.sel.ddOpen)};b.prototype.showFilter=function(){this.element.classList.add(this.sel.ddFilterActive)};
b.prototype.hideFilter=function(){this.element.classList.remove(this.sel.ddFilterActive)};b.prototype.changeTitle=function(a){this.title.innerText=a};b.prototype.visibleItems=function(a){a=a.map(function(a){return a.id});for(var d=0;d<this.itemList.length;d++){var b=this.itemList[d].getElementsByTagName("a")[0].dataset.listId;0<=a.indexOf(b)?this.itemList[d].style.display="":this.itemList[d].style.display="none"}};b.prototype.selectItem=function(a){a.target!==a.currentTarget&&(a.stopPropagation(),
this.setActiveItem(a.target))};b.prototype.focusOut=function(a){this.controller.isOpen()&&(a=a.target,(a!==this.element&&!this.element.contains(a)||a.classList.contains("ds2-dropdown-filter-wrapper"))&&this.controller.close())};b.prototype.setActiveItem=function(a){var d=this.element.getElementsByClassName(this.sel.ddItem),b=[],c;for(c in d)d.hasOwnProperty(c)&&b.push(d[c]);b.forEach(function(b){b===a.parentNode?b.classList.add(this.sel.ddItemActive):b.classList.remove(this.sel.ddItemActive)}.bind(this));
this.controller.selectItem(a)};return b});
define("ds2-dropdown-controller",[],function(){var c=function(b){if(!b||!b.uid)throw Error("DropdownController: Model is required.");this.model=b;this.uid=this.model.uid};c.prototype.toggleOpen=function(b){b.preventDefault();this.model.isOpen()?this.model.close():this.model.open()};c.prototype.close=function(b){this.model.close()};c.prototype.isOpen=function(){return this.model.isOpen()};c.prototype.hasFilter=function(){return this.model.hasFilter()};c.prototype.checkFilter=function(){this.model.hasFilter()?
this.model.showFilter():this.model.hideFilter()};c.prototype.selectItem=function(b){b&&"-1"!==b.getAttribute("tabindex")&&(this.model.currentItem=b.getAttribute("data-list-id"),this.model.setTitle(b.innerText.trim()),this.model.close())};c.prototype.applyFilter=function(b){var a=b.target.value.toLowerCase();b=this.model.getListItems().filter(function(b){return 0<=b.value.indexOf(a)});this.model.setVisibleItems(b)};c.prototype.setItemList=function(b){b=Array.prototype.slice.call(b).map(function(a){var b=
a.getElementsByTagName("a")[0];a=b.dataset.listId;b=b.innerText.toLowerCase();return{id:a,value:b}});this.model.setItemList(b)};c.prototype.shouldPreselectItem=function(){return this.model.shouldPreselectItem()};return c});
define("ds2-dropdown-accessibility",["ds2-touch-detection","ds2-accessibility"],function(c,b){var a=function(a){if(!a||!a.element)throw Error("Dropdown accessibility: Element is required.");if(!a.emitter||!a.controller||a.emitter.uid!==a.controller.uid)throw Error("DropdownView: Emitter and controller are required.");this.element=a.element;this.emitter=a.emitter;this.controller=a.controller;this.accessibility=new b(this.element);this.emitter.on("listitems-change",this.visibleItems.bind(this));this.isTouch=
c.any;this.focusIndex=-1;this.$dropdown=$(this.element);this.$dropdownEntries=this.$dropdown.find("ul");this.$dropdownEntrylist=this.$dropdown.find(".ds2-dropdown__box-shadow-wrapper");this.$dropdownFilter=this.$dropdown.find(".ds2-dropdown__filter");this.init();this.filterListener()};a.prototype.init=function(){var a=this;this.accessibility.addKeyListener("down",{element:this.$dropdown,keyCodes:[this.accessibility.keyCodes.ESC],cancel:!0,fn:function(){a.controller.close();a.focusIndex=a.focusableElements.length-
1;setTimeout(function(){a.$dropdown.find("button").focus()}.bind(this),100)}});this.accessibility.addKeyListener("down",{element:this.$dropdownEntrylist,keyCodes:[this.accessibility.keyCodes.ARROW_DOWN,this.accessibility.keyCodes.TAB],cancel:!0,fn:function(){a.focusNextDropdownItem()}});this.accessibility.addKeyListener("down",{element:this.$dropdownEntrylist,keyCodes:[this.accessibility.keyCodes.ARROW_UP],cancel:!0,fn:function(){a.focusPreviousDropdownItem()}});this.accessibility.addKeyListener("down",
{element:this.$dropdownEntrylist,keyCodes:[this.accessibility.keyCodes.TAB],cancel:!0,shiftKey:!0,fn:function(){a.focusPreviousDropdownItem()}});this.accessibility.addKeyListener("down",{element:this.$dropdownEntries,keyCodes:[this.accessibility.keyCodes.SPACE,this.accessibility.keyCodes.ENTER],cancel:!0,fn:function(){a.selectFocusedEntry()}});this.updateFocusableElements()};a.prototype.visibleItems=function(){setTimeout(function(){this.updateFocusableElements()}.bind(this),250)};a.prototype.focusNextDropdownItem=
function(){this.$dropdown.hasClass("ds2-dropdown--open")&&(1===this.focusableElements.length&&this.updateFocusableElements(),this.setFocusIndex(1),this.focusableElements[this.focusIndex].focus())};a.prototype.focusPreviousDropdownItem=function(){this.$dropdown.hasClass("ds2-dropdown--open")&&(1===this.focusableElements.length&&this.updateFocusableElements(),this.setFocusIndex(-1),this.focusableElements[this.focusIndex].focus())};a.prototype.updateFocusableElements=function(a){this.focusableElements=
this.accessibility.getKeyboardFocusableElements(this.$dropdown.find(".ds2-dropdown-list"));this.controller.hasFilter()&&this.focusableElements.push(this.$dropdownFilter);this.focusIndex=a?parseInt(a,10):this.focusableElements.length-1};a.prototype.selectFocusedEntry=function(){!this.isTouch&&this.$dropdown.hasClass("ds2-dropdown--open")&&(this.focusableElements[this.focusIndex].click(),$(this.focusableElements[this.focusIndex]).addClass("ds2-dropdown-list__item--active"),this.focusIndex=this.focusableElements.length-
1,setTimeout(function(){this.$dropdown.find("button").focus()}.bind(this),100))};a.prototype.setFocusIndex=function(a){var b=this.focusableElements.length;this.focusIndex=-1===this.focusIndex?b-1:this.focusIndex===b-1&&1===a?0:0===this.focusIndex&&-1===a?b-1:this.focusIndex+a};a.prototype.filterListener=function(){(this.filter=this.element.querySelector(".ds2-dropdown__filter"))&&this.filter.addEventListener("keyup",function(){var a=this.parentElement.parentElement,b=a.querySelectorAll(".ds2-dropdown-list__item");
if(a=a.querySelector(".ds2-dropdown__error-message")){a.style.display="none";for(var c=0,e=0;e<b.length;e++)"none"===b[e].style.display&&c++;b.length-1<c&&a.removeAttribute("style")}})};return a});
define("ds2-mvc-dropdown",["ds2-mvc-emitter","ds2-dropdown-model","ds2-dropdown-controller","ds2-dropdown-view","ds2-dropdown-accessibility"],function(c,b,a,d,h){return function(g){var e=new c,f=g.classList.contains("ds2-dropdown--filter-inactive");f=new b(e,{isOpen:!1,showFilter:!f,skipPreselection:"undefined"!==typeof g.dataset.skipPreselection});f=new a(f);var k=new h({element:g,emitter:e,controller:f});new d({element:g,emitter:e,controller:f,accessibility:k,parentClass:"ds2-dropdown",hash:window.location.hash,
skipPreselection:!0});return e}});