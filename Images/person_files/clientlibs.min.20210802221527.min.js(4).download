define("ds2-lastconfig",["jquery"],function(e){var k=function(a){this.LAST_CONFIG_COOKIE_NAME="last_config";this.SCREEN_BREAKING_POINT=980;this.COSY_URL="https://cosy.bmwgroup.com/ivis/cosySec?";this.FABRIC=this.BRAND=this.MMDR=this.RIM=this.VEHICLE=this.PAINT=this.SA="";this.isSmallScreen=!1;this.cta;this.$component=e(a);this.cta=this.$component.find(".ds2-rlc-button");this.url="";this.init()},c=k.prototype;c.getLastConfigCookie=function(){var a=this.$component.data("test-cookie");return a?decodeURIComponent(a):
window.consentcontroller?window.consentcontroller.api.getPersistence(this.LAST_CONFIG_COOKIE_NAME):null};c.readLastConfigCookie=function(){var a=this.getLastConfigCookie();if(a)try{return JSON.parse(a)}catch(h){return console.log("Cannot parse "+this.LAST_CONFIG_COOKIE_NAME+" cookie value"),null}};c.readCarData=function(a){if(void 0!==a&&null!==a)try{if(a&&(a.ag_modelcode||a.modelcode)&&a.brandCosy&&a.modelrange&&a.options&&0<a.options.length){var h=a.brandCosy,b=a.ag_modelcode?a.ag_modelcode:a.modelcode,
c=a.modelrange,d="";a.rim&&0<a.rim.length&&(d=a.rim);var f="";a.paint&&0<a.paint.length&&(f=a.paint);var g="";a.fabric&&0<a.fabric.length&&(g=a.fabric);var m=a.options,l=m.split(",");a=[];a.push(d,g,f);for(var k=[],n=0;n<l.length;n++)a.includes(l[n])||k.push(l[n]);m=k.toString();l=[m,f,b,d,c,h,g];this.SA=m;this.PAINT=f;this.VEHICLE=b;this.RIM=d;this.MMDR=c;this.BRAND=h;this.FABRIC=g;-1<e.inArray("",l)&&console.log("No empty values should be present in the cookie.");return l}}catch(p){console.log("Connot read car data")}return null};
c.refreshScreenInfo=function(){this.view="desktop";this.isSmallScreen=!1;window.innerWidth<=this.SCREEN_BREAKING_POINT&&(this.view="mobile",this.isSmallScreen=!0)};c.getCar=function(a,h,b){var c="4Zak0rQzNsXdVEl3S1CTuf7yJ%tmLHwYqoi6Dh9pjMbG2ePUvBW8gIKx5OFcRnA";b&&(c="4Zak0rQzNsXdVEl3S1CTuf7yJ%tmLHwYqoi6Dh9pjMbG2ePUvBW8gIKx5OFcRnA");var d,f;b="";h?(d=17+63*Math.random(),f=11+63*Math.random()):(d=25,f=45);h="COSY-EU-100-"+d+f;var g=this.getUrl(a);for(a=0;a<g.length;a++)switch(g.charAt(a)){case "+":b+=
"%20";break;case "-":b+="%2D";break;case "_":b+="%5F";break;case ".":b+="%2E";break;case "*":b+="%2A";break;default:b+=g.charAt(a)}for(a=0;a<b.length;a++)h+=c.charAt((d+c.indexOf(b.charAt(a)))%63),d+=f;return encodeURI(h)};c.getUrl=function(a){var c="",b=0;a=a.toString();for(var e=/(^[a-zA-Z0-9_.]*)/;b<a.length;){var d=e.exec(a.substr(b));null!=d&&1<d.length&&""!=d[1]?(c+=d[1],b+=d[1].length):(" "==a[b]?c+="+":(d=a.charCodeAt(b).toString(16),c+="%"+(2>d.length?"0":"")+d.toUpperCase()),b++)}return c};
c.getCosyImage=function(a,c){var b="";if("mobile"===a)switch(c){case "frontview":b="CLIENT\x3dNVCO\x26BRAND\x3d"+this.BRAND+"\x26VEHICLE\x3d"+this.VEHICLE+"\x26ANGLE\x3d345\x26POV\x3dWALKAROUND\x26RESP\x3djpg\x26BKGND\x3d#EEEEEE\x26SA\x3d"+this.SA+","+this.RIM+"\x26PAINT\x3d"+this.PAINT+"\x26VAR_PLATE\x3d\x26PRODDATE\x3d\x26FABRIC\x3d"+this.FABRIC+"\x26QUALITY\x3d80\x26X\x3d1800\x26Y\x3d2800\x26CUT\x3d1\x26H\x3d6500\x26WIDTH\x3d450\x26HEIGHT\x3d320\x26SA\x3dCTRLNoLicensePlate";break;case "tyre":b=
"CLIENT\x3dNVCO\x26BRAND\x3d"+this.BRAND+"\x26VEHICLE\x3d"+this.VEHICLE+"\x26ANGLE\x3d160\x26POV\x3dWALKAROUND\x26RESP\x3djpg\x26BKGND\x3d#EEEEEE\x26WIDTH\x3d250\x26HEIGHT\x3d200\x26SA\x3d"+this.SA+","+this.RIM+"\x26PAINT\x3d"+this.PAINT+"\x26VAR_PLATE\x3d\x26PRODDATE\x3d\x26FABRIC\x3d"+this.FABRIC+"\x26QUALITY\x3d80\x26X\x3d-1100\x26Y\x3d2100\x26CUT\x3d1\x26H\x3d4000\x26SA\x3dCTRLNoLicensePlate";break;case "backview":b="BRAND\x3d"+this.BRAND+"\x26WIDTH\x3d200\x26HEIGHT\x3d180\x26RESP\x3dpng\x26BKGND\x3dTRANSPARENT\x26CLIENT\x3dSTATIC\x26ANGLE\x3d0\x26view\x3drim_1000x1000_transparent\x26VEHICLE\x3d"+
this.VEHICLE+"\x26SA\x3d"+this.RIM+"\x26X\x3d0\x26Y\x3d0"}else switch(c){case "frontview":b="CLIENT\x3dNVCO\x26BRAND\x3d"+this.BRAND+"\x26VEHICLE\x3d"+this.VEHICLE+"\x26ANGLE\x3d0\x26POV\x3dWALKAROUND\x26RESP\x3djpg\x26BKGND\x3d#EEEEEE\x26WIDTH\x3d450\x26HEIGHT\x3d360\x26SA\x3d"+this.SA+","+this.RIM+"\x26PAINT\x3d"+this.PAINT+"\x26VAR_PLATE\x3d\x26PRODDATE\x3d\x26FABRIC\x3d"+this.FABRIC+"\x26QUALITY\x3d80\x26X\x3d900\x26Y\x3d2500\x26CUT\x3d1\x26H\x3d4000\x26SA\x3dCTRLNoLicensePlate";break;case "tyre":b=
"BRAND\x3d"+this.BRAND+"\x26WIDTH\x3d200\x26HEIGHT\x3d180\x26RESP\x3dpng\x26BKGND\x3dTRANSPARENT\x26CLIENT\x3dSTATIC\x26ANGLE\x3d0\x26view\x3drim_1000x1000_transparent\x26VEHICLE\x3d"+this.VEHICLE+"\x26SA\x3d"+this.RIM+"\x26X\x3d0\x26Y\x3d-4000";break;case "backview":b="CLIENT\x3dNVCO\x26BRAND\x3d"+this.BRAND+"\x26VEHICLE\x3d"+this.VEHICLE+"\x26ANGLE\x3d160\x26POV\x3dWALKAROUND\x26RESP\x3djpg\x26BKGND\x3d#EEEEEE\x26WIDTH\x3d450\x26HEIGHT\x3d200\x26SA\x3d"+this.SA+","+this.RIM+"\x26PAINT\x3d"+this.PAINT+
"\x26VAR_PLATE\x3d\x26PRODDATE\x3d\x26FABRIC\x3d"+this.FABRIC+"\x26QUALITY\x3d80\x26X\x3d-300\x26Y\x3d2100\x26CUT\x3d1\x26H\x3d4000\x26SA\x3dCTRLNoLicensePlate";break;case "sideview":b="CLIENT\x3dNVCO\x26BRAND\x3d"+this.BRAND+"\x26VEHICLE\x3d"+this.VEHICLE+"\x26ANGLE\x3d90\x26POV\x3dWALKAROUND\x26RESP\x3dpng\x26BKGND\x3dTRANSPARENT\x26WIDTH\x3d350\x26HEIGHT\x3d280\x26SA\x3d"+this.SA+","+this.RIM+"\x26PAINT\x3d"+this.PAINT+"\x26VAR_PLATE\x3d\x26PRODDATE\x3d\x26FABRIC\x3d"+this.FABRIC+"\x26QUALITY\x3d80\x26X\x3d-2000\x26Y\x3d1100\x26CUT\x3d1\x26H\x3d7000\x26SA\x3dCTRLNoLicensePlate"}return this.COSY_URL+
this.getCar(b)};c.setBackgroundImages=function(){e(".ds2-rlc-frontview").css("background-image","url("+this.getCosyImage(this.view,"frontview")+")");e(".ds2-rlc-tyre").css("background-image","url("+this.getCosyImage(this.view,"tyre")+")");e(".ds2-rlc-backview").css("background-image","url("+this.getCosyImage(this.view,"backview")+")");this.isSmallScreen||e(".ds2-rlc-sideview").css("background-image","url("+this.getCosyImage(this.view,"sideview")+")")};c.setUrl=function(){window&&(this.url=this.conUrl+
this.MMDR+"/"+this.VEHICLE+"/"+this.FABRIC+","+this.PAINT+","+this.SA,this.cta.attr("href",this.url),this.$component.find("a.clickable").attr("href",this.url))};c.showComponent=function(a,c,b,e,d,f,g,k){this.RIM||this.$component.addClass("norim-fallback");this.refreshScreenInfo();this.setBackgroundImages();this.setUrl();this.$component.show()};c.attachWindowResizeEvent=function(){var a=this;e(window).resize(function(){if(window.innerWidth<=a.SCREEN_BREAKING_POINT&&!a.isSmallScreen||window.innerWidth>
a.SCREEN_BREAKING_POINT&&a.isSmallScreen)a.refreshScreenInfo(),a.setBackgroundImages()})};c.handleTrackingAttributes=function(){var a=this.$component.attr("data-tracking-regionid").toLowerCase();this.$component.attr("data-tracking-regionid",a);this.url&&(a='var s_objectID\x3d"'+('data-tracking-linkid\x3d"continue now:'+this.url+'"').toLowerCase()+'"',this.cta.attr("onClick",a),this.$component.find(".clickable").attr("onClick",a))};c.init=function(){var a=this.readLastConfigCookie();this.conUrl=this.$component.attr("data-con-url");
(a=this.readCarData(a))?(this.showComponent(a),this.attachWindowResizeEvent()):this.$component.parent().find(".ds2-remember-last-configuration-fallback").show();this.handleTrackingAttributes()};return k});